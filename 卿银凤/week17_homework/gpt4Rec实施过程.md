### **gpt4Rec 实施过程总结**
#### **1. 整体框架设计**
- **任务拆解**：
  - **查询生成**：基于用户历史行为生成多个“搜索查询”。
  - **物品检索**：使用搜索引擎根据查询检索相关物品。
- **核心组件**：
  - **生成式语言模型**：用于学习用户和物品在语言空间的表示，并生成查询。
  - **搜索引擎**：用于根据查询检索物品。

#### **2. 查询生成阶段**
- **语言模型选择**：使用 **GPT-2** 作为生成模型。
- **输入格式化**
- **多查询生成策略**：使用 **波束搜索（beam search）** 生成多个查询。

#### **3. 物品检索阶段**
- **搜索引擎选择**：使用 **BM25** 作为检索模型。

#### **4. 训练策略**
- **两步训练法**：1. 语言模型微调 2. 搜索引擎参数优化

#### **5. 实验设置**
- **数据集**：Amazon Review 数据中的 Beauty 和 Electronics 类别。
- **数据预处理**：
  - 过滤标题缺失或过长（>400字符）的物品。
  - 用户序列去重并截断至最多15个物品。
- **评估指标**：
  - 主指标：Recall@K
  - 辅助指标：Diversity@K（基于品类/品牌），Coverage@K（覆盖用户历史兴趣）
- **基线模型**：FM-BPR、ContentRec、YouTubeDNN、BERT4Rec

