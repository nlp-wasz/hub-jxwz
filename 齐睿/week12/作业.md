1. 复现现有职能助手代码，环境要有 fastmcp、streamlit、openai-agent 库。
python mcp_server_main.py
streamlit run streamlit_demo.py

![项目复现截图.png](https://github.com/Bpig-C/hub-jxwz/blob/main/%E9%BD%90%E7%9D%BF/week12/%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E6%88%AA%E5%9B%BE.png?raw=true)

2. 尝试新定义一个工具，进行文本情感分析，输入文本判断文本的情感类别。最终可以在界面通过agent 在对话中调用这个工具。

@mcp.tool
def sentiment_classification(text: Annotated[str, "The text to analyze"]):
    """Classifies the sentiment of a given text."""
    pass
![情感分析工具截图.png](https://github.com/Bpig-C/hub-jxwz/blob/main/%E9%BD%90%E7%9D%BF/week12/%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7%E6%88%AA%E5%9B%BE.png?raw=true)

3. 尝试需要在对话中选择工具，增加 tool_filter 的逻辑。
    - 查询新闻的时候，只调用news的工具
    - 调用工具的时候，只调用tools的工具
我现在使用的是前端标签选择+FastMCP服务分端口启动的方式实现该逻辑：
前端过滤工具和问答页面显示：
![image3](https://github.com/Bpig-C/hub-jxwz/blob/main/%E9%BD%90%E7%9D%BF/week12/%E5%89%8D%E7%AB%AF%E8%BF%87%E6%BB%A4%E5%B7%A5%E5%85%B7%E5%92%8C%E9%97%AE%E7%AD%94%E9%A1%B5%E9%9D%A2%E6%98%BE%E7%A4%BA.png?raw=true)
当未选择对应工具时无法使用工具：
![image4](https://github.com/Bpig-C/hub-jxwz/blob/main/%E9%BD%90%E7%9D%BF/week12/%E6%9C%AA%E9%80%89%E6%8B%A9%E5%AF%B9%E5%BA%94%E5%B7%A5%E5%85%B7%E6%97%B6%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7.png?raw=true)
后端MCP服务器通过tag过滤启动多端口服务：

![image5](https://github.com/Bpig-C/hub-jxwz/blob/main/%E9%BD%90%E7%9D%BF/week12/%E5%90%8E%E7%AB%AFMCP%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%80%9A%E8%BF%87tag%E8%BF%87%E6%BB%A4%E5%90%AF%E5%8A%A8%E5%A4%9A%E7%AB%AF%E5%8F%A3%E6%9C%8D%E5%8A%A1.png?raw=true)
但是这种方法明显不太符合真正的应用场景，而且当前的调试信息略显黑盒，我后续会考虑进行优化和改进。
