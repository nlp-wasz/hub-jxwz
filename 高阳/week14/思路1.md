### 项目概述

本项目的目的是解决基于PDF文档中的大量公式进行智能问答的问题。
通过结合RAG和LLM的方式，从众多公式中召回最相关的TopN条目，并利用大模型对问题进行理解和计算，最终输出数值型的答案。


### 主要流程

#### 1. 数据准备

- 使用 `pandas` 加载Excel文件 `./user_data/tmp_data/md.xlsx` 中的文本数据。
- 合并Markdown格式的文档内容，构建完整的语料库 [contents]。
- 读取问题集 [question.csv] 文件，其中每行为一个待解答的问题。


#### 2. 文档嵌入

- 使用本地模型 `Qwen3-Embedding-0.6B` 对整个语料库进行向量化处理。
- 将所有文档转换为向量形式存储在 `corpus_embeddings` 中，以便后续相似度匹配。


#### 3. 大模型配置

- 利用大模型（如 Qwen3-235B-A22B-Thinking-2507），理解和执行复杂逻辑推理任务。


#### 4. Prompt模板定义

- 定义了一个详细的Prompt Template `template`，指导大模型如何选择合适的公式、判断是否可估算缺失变量以及最终输出结构化JSON格式结果。


#### 5. 查询处理函数

对于每一个输入问题：

1. 对其进行编码得到查询向量 `query_embedding`；
2. 计算与语料库中各文档的余弦相似度得分；
3. 取前8个最高分文档作为候选公式集合；
4. 构造完整的提示词消息 [message]，并发送给大模型获取响应。


#### 6. 结果处理与输出

- 所有原始应答先被写入 [.jsonl]文件中；
- 接着使用正则表达式提取真正的JSON格式答案；
- 对无法解析的回答统一赋默认值"10"（代表无效/未识别）；
- 最终整理成DataFrame并导出为CSV文件供提交。